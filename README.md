# Анализ Линейной Многофакторной Модели (ЛМФМ)

## **Цель работы и постановка задачи**

Цель данного проекта — разработать программу, которая:

1. Считывает временные ряды отклика (`y`) и факторов (`X`) из файла.
2. Строит Линейную Многофакторную Модель (ЛМФМ), выполняя:
   - Оценку параметров модели.
   - Отбор значимых факторов на основе критериев, заданных пользователем.
   - Оценку адекватности модели с использованием статистических метрик.
3. Выполняет предсказание с использованием построенной модели.
4. Визуализирует производительность модели на обучающей и тестовой выборках.

Дополнительные функции включают создание лаговых признаков для факторов и выделение подмножества ряда отклика для проведения анализа. Эти функции позволяют учитывать временные зависимости и настраивать модель.

---

## **Процедура построения и оценки ЛМФМ**

1. **Загрузка данных**
   - Данные загружаются из набора `fetch_california_housing`, предоставленного библиотекой `sklearn`.
   - Ряд отклика (`y`) — это целевая цена жилья (`PRICE`), а факторы (`X`) включают такие предикторы, как медианный доход, возраст дома и т.д.
    - Ссылка на данные: https://scikit-learn.org/stable/modules/generated/sklearn.datasets.fetch_california_housing.html

2. **Создание лаговых признаков**
   - Временные зависимости в данных обрабатываются с помощью создания лаговых признаков для всех факторов. Пользователь может указать количество лагов (`lags`).

3. **Выделение подмножества ряда отклика**
   - Пользователь может выделить подмножество ряда отклика, указав начальный (`start`) и конечный (`end`) индексы для анализа.

4. **Обучение модели**
   - На основе выбранных факторов обучается линейная регрессионная модель.

5. **Отбор значимых факторов**
   - Факторы оцениваются на основе:
     - **Статистической значимости**: Используются корреляция Пирсона и p-value.
     - **Мультиколлинеарности**: Идентифицируются сильно коррелированные факторы, которые пользователь может поэтапно удалять.

6. **Оценка адекватности модели**
   - Модель оценивается с использованием:
     - R-квадрата (R²) для оценки качества подгонки.
     - Среднеквадратичной ошибки (MSE) для анализа ошибок.

7. **Визуализация**
   - Предсказания модели визуализируются как для обучающей, так и для тестовой выборки, что позволяет сравнить их с фактическими значениями.

---

## **Демонстрация работы программы**

### **Выполнение**

1. Запустите программу, выполнив соответствующие ячейки:

   LinReg_Витко.М.А_mathforecast.ipynb


2. Программа запросит у пользователя:
   - Указать количество лагов для создания.
   - Задать начальный и конечный индексы ряда отклика.

3. Во время выполнения пользователь может:
   - Просмотреть список значимых факторов на основе p-value и корреляции.
   - Поэтапно удалить факторы с высокой мультиколлинеарностью.

4. Программа выводит:
   - Метрики адекватности модели (R² и MSE) для обучающей и тестовой выборок.
   - Визуализацию производительности модели на обучающей и тестовой выборках.

### **Входные данные**
- Используемый набор данных — **California Housing Dataset**, автоматически загружается с помощью `sklearn.datasets.fetch_california_housing`.

### **Выходные данные**
- **Метрики модели**: R² и MSE для обучающей и тестовой выборок.
- **Пример вывода**:
  
Enter the number of lags to create: 0
Enter the start index for the response series: 100
Enter the end index for the response series: 800
Significant factors based on p-value: [('MedInc', 0.743011543622697), ('AveRooms', 0.5715148935845864), ('AveBedrms', -0.14640558574631876), ('AveOccup', -0.2005597843292827), ('Latitude', 0.3226904694136209), ('Longitude', -0.15870622087476102)]
Highly correlated factor pairs: [('Latitude', 'Longitude'), ('Longitude', 'Latitude')]
Current factors: ['MedInc', 'HouseAge', 'AveRooms', 'AveBedrms', 'Population', 'AveOccup', 'Latitude', 'Longitude']
Enter the name of the factor to remove (or 'done' to finish): done
Train R^2: 0.6427939480527547, Train MSE: 0.2899918920095588
Test R^2: 0.754694054244831, Test MSE: 0.20631366574466187

**Выводы модели находятся** в "Вывод модели.txt"



---

## **Примеры визуализации**

- **Обучающая выборка**: Диаграмма рассеяния, показывающая предсказанные и фактические значения для обучающей выборки.

  ![image](https://github.com/user-attachments/assets/0e80e37c-bd49-433e-9cea-733a8c93f121)

  
- **Тестовая выборка**: Диаграмма рассеяния, показывающая предсказанные и фактические значения для тестовой выборки.

![image](https://github.com/user-attachments/assets/e0a9cd14-a864-495a-881e-028f4eeddb1c)
---


